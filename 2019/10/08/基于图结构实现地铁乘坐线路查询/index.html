<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="基于图结构实现地铁乘坐线路查询 github-python算法和flaskapp部分：repo github-android部分：repo flaskapp接口文档：传送门 深度了解Dijkstra优化算法：传送门 personblog:github_page or csdnblog   问题描述编写一个程序实现地铁最短乘坐（站）线路查询，输入为起始站名和目的站名，输出为从起始站到目的站的最短乘坐">
<meta property="og:type" content="article">
<meta property="og:title" content="基于图结构实现地铁乘坐线路查询">
<meta property="og:url" content="http://yoursite.com/2019/10/08/基于图结构实现地铁乘坐线路查询/index.html">
<meta property="og:site_name" content="年轻派">
<meta property="og:description" content="基于图结构实现地铁乘坐线路查询 github-python算法和flaskapp部分：repo github-android部分：repo flaskapp接口文档：传送门 深度了解Dijkstra优化算法：传送门 personblog:github_page or csdnblog   问题描述编写一个程序实现地铁最短乘坐（站）线路查询，输入为起始站名和目的站名，输出为从起始站到目的站的最短乘坐">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191008164044443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nvczc2OA==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191008164422968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nvczc2OA==,size_16,color_FFFFFF,t_70">
<meta property="og:updated_time" content="2019-10-08T09:42:57.979Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于图结构实现地铁乘坐线路查询">
<meta name="twitter:description" content="基于图结构实现地铁乘坐线路查询 github-python算法和flaskapp部分：repo github-android部分：repo flaskapp接口文档：传送门 深度了解Dijkstra优化算法：传送门 personblog:github_page or csdnblog   问题描述编写一个程序实现地铁最短乘坐（站）线路查询，输入为起始站名和目的站名，输出为从起始站到目的站的最短乘坐">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20191008164044443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nvczc2OA==,size_16,color_FFFFFF,t_70">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/10/08/基于图结构实现地铁乘坐线路查询/">





  <title>基于图结构实现地铁乘坐线路查询 | 年轻派</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">年轻派</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/08/基于图结构实现地铁乘坐线路查询/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Athony Oliver">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="年轻派">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">基于图结构实现地铁乘坐线路查询</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-08T17:13:35+08:00">
                2019-10-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="基于图结构实现地铁乘坐线路查询"><a href="#基于图结构实现地铁乘坐线路查询" class="headerlink" title="基于图结构实现地铁乘坐线路查询"></a>基于图结构实现地铁乘坐线路查询</h2><ul>
<li>github-python算法和flaskapp部分：<a href="https://github.com/zhang-wangz/stationplan" target="_blank" rel="noopener">repo</a></li>
<li>github-android部分：<a href="https://github.com/zhang-wangz/station-android-ui" target="_blank" rel="noopener">repo</a></li>
<li>flaskapp接口文档：<a href="https://www.showdoc.cc/501748289952061?page_id=2960311511791788" target="_blank" rel="noopener">传送门</a></li>
<li>深度了解Dijkstra优化算法：<a href="https://www.cnblogs.com/jason2003/p/7222182.html" target="_blank" rel="noopener">传送门</a></li>
<li>personblog:<a href="https://zhang-wangz.github.io/2019/10/08/%E5%9F%BA%E4%BA%8E%E5%9B%BE%E7%BB%93%E6%9E%84%E5%AE%9E%E7%8E%B0%E5%9C%B0%E9%93%81%E4%B9%98%E5%9D%90%E7%BA%BF%E8%B7%AF%E6%9F%A5%E8%AF%A2/" target="_blank" rel="noopener">github_page</a> or <a href="https://blog.csdn.net/sos768/article/details/102392971" target="_blank" rel="noopener">csdnblog</a></li>
</ul>
<hr>
<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>编写一个程序实现地铁最短乘坐（站）线路查询，输入为起始站名和目的站名，输出为从起始站到目的站的最短乘坐站换乘线路。</p>
<p>1.采用Dijkstra算法实现，使用优先队列对性能进行了优化；<br>2.如果两站间存在多条最短路径，则输出其中的一条即可；</p>
<ul>
<li>本次项目实现采用了flask作为后端提供接口服务，使用androidApp进行get请求获得数据，显示在Textview中<h2 id="设计需求"><a href="#设计需求" class="headerlink" title="设计需求"></a>设计需求</h2></li>
<li>确定储存地铁站文件的格式文件       （已确认使用json格式和文本格式）</li>
<li>确定读取地铁站数据的方式              （使用python的file打开命令）</li>
<li>确定获取两站点最小站点数的算法方式</li>
<li>进行外表封装</li>
<li>进行输出格式的确定</li>
<li>性能测试</li>
<li>最后结果检查</li>
</ul>
<hr>
<h2 id="数据存储格式"><a href="#数据存储格式" class="headerlink" title="数据存储格式"></a>数据存储格式</h2><p>stationline.txt文本为存储的地图数据文本，格式如下图所示：</p>
<ul>
<li>使用0与1来分别表示是否需要换乘</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">地铁线路条数</span><br><span class="line">线路x 线路x站数</span><br><span class="line">站名<span class="number">1</span> 是否需要换乘</span><br><span class="line">站名<span class="number">2</span> 是否需要换乘</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<ul>
<li>数据示例<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">20</span></span><br><span class="line">曹庄 <span class="number">0</span> </span><br><span class="line">卞兴 <span class="number">0</span></span><br><span class="line">芥园西道 <span class="number">0</span></span><br><span class="line">咸阳路 <span class="number">0</span></span><br><span class="line">长虹公园 <span class="number">1</span></span><br><span class="line">广开四马路 <span class="number">0</span></span><br><span class="line">西南角 <span class="number">1</span></span><br><span class="line">鼓楼 <span class="number">0</span></span><br><span class="line">东南角 <span class="number">0</span></span><br><span class="line">建国道 <span class="number">0</span></span><br><span class="line">天津站 <span class="number">1</span></span><br><span class="line">远洋国际中心 <span class="number">0</span></span><br><span class="line">顺驰桥 <span class="number">0</span></span><br><span class="line">靖江路 <span class="number">1</span></span><br><span class="line">翠阜新村 <span class="number">0</span></span><br><span class="line">屿东城 <span class="number">0</span></span><br><span class="line">登州路 <span class="number">0</span></span><br><span class="line">国山路 <span class="number">0</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="数据文本读取代码"><a href="#数据文本读取代码" class="headerlink" title="数据文本读取代码"></a>数据文本读取代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(os.path.join(os.path.abspath(<span class="string">'..'</span>), <span class="string">"station/stationLine.txt"</span>), <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    TOTAL = f.readline()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        <span class="keyword">if</span> line != <span class="string">'\n'</span>:</span><br><span class="line">            line = line.rstrip(<span class="string">'\n'</span>)</span><br><span class="line">            line = line.split(<span class="string">' '</span>)</span><br><span class="line">            <span class="keyword">if</span> line[<span class="number">0</span>] <span class="keyword">in</span> LINEDATA:</span><br><span class="line">                linei = line[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            line[<span class="number">1</span>] = linei</span><br><span class="line">            line0 = line[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            intline = int(line[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> intline <span class="keyword">not</span> <span class="keyword">in</span> data.keys():</span><br><span class="line">                data[intline] = []</span><br><span class="line">                data[intline].append(line0)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data[intline].append(line0)</span><br><span class="line">            <span class="keyword">if</span> line0 <span class="keyword">not</span> <span class="keyword">in</span> datanum.keys():</span><br><span class="line">                datanum[line0] = [intline]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                datanum[line0].append(intline)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>打印结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">stationline &#123;<span class="string">"1"</span>: [<span class="string">"刘园"</span>, <span class="string">"西横堤"</span>, <span class="string">"果酒厂"</span>, <span class="string">"本溪路"</span>, <span class="string">"勤俭道"</span>, <span class="string">"洪湖里"</span>, <span class="string">"西站"</span>, <span class="string">"西北角"</span>, ..]&#125;</span><br><span class="line"></span><br><span class="line">linesdata &#123;<span class="string">"刘园"</span>: [<span class="number">1</span>], <span class="string">"西横堤"</span>: [<span class="number">1</span>], <span class="string">"果酒厂"</span>: [<span class="number">1</span>], <span class="string">"本溪路"</span>: [<span class="number">1</span>], <span class="string">"勤俭道"</span>: [<span class="number">1</span>], <span class="string">"洪湖里"</span>: [<span class="number">1</span>], <span class="string">"西站"</span>: [<span class="number">1</span>, <span class="number">6</span>], <span class="string">"西北角"</span>: [<span class="number">1</span>], <span class="string">"西南角"</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">"二纬路"</span>: [<span class="number">1</span>], <span class="string">"海光寺"</span>: [<span class="number">1</span>], <span class="string">"鞍山道"</span>: [<span class="number">1</span>], <span class="string">"营口道"</span>: [<span class="number">1</span>, <span class="number">3</span>], <span class="string">"小白楼"</span>: [<span class="number">1</span>], <span class="string">"下瓦房"</span>: [<span class="number">1</span>, <span class="number">5</span>],....&#125;</span><br><span class="line"></span><br><span class="line">station_num &#123;<span class="string">"刘园"</span>: <span class="number">0</span>, <span class="string">"西横堤"</span>: <span class="number">1</span>, <span class="string">"果酒厂"</span>: <span class="number">2</span>, <span class="string">"本溪路"</span>: <span class="number">3</span>, <span class="string">"勤俭道"</span>: <span class="number">4</span>, <span class="string">"洪湖里"</span>: <span class="number">5</span>, <span class="string">"西站"</span>: <span class="number">6</span>, <span class="string">"西北角"</span>: <span class="number">7</span>, <span class="string">"西南角"</span>: <span class="number">8</span>, <span class="string">"二纬路"</span>: <span class="number">9</span>, <span class="string">"海光寺"</span>: <span class="number">10</span>, <span class="string">"鞍山道"</span>: <span class="number">11</span>, <span class="string">"营口道"</span>: <span class="number">12</span>, <span class="string">"小白楼"</span>: <span class="number">13</span>, <span class="string">"下瓦房"</span>: <span class="number">14</span>,.....&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获得点与点之间的最短路径:</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_shortest_path</span><span class="params">(graph, start, end, path=[])</span>:</span></span><br><span class="line">    <span class="comment"># 查找最短路径</span></span><br><span class="line">    path = path + [start]</span><br><span class="line">    <span class="keyword">if</span> start == end:</span><br><span class="line">        <span class="keyword">return</span> path</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> start <span class="keyword">in</span> graph.keys():</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    shortest = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> graph[start]:</span><br><span class="line">        <span class="keyword">if</span> node <span class="keyword">not</span> <span class="keyword">in</span> path:</span><br><span class="line">            newpath = find_shortest_path(graph, node, end, path)</span><br><span class="line">            <span class="keyword">if</span> newpath:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> shortest <span class="keyword">or</span> len(newpath) &lt; len(shortest):</span><br><span class="line">                    shortest = newpath</span><br><span class="line">    <span class="keyword">return</span> shortest</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_all_paths</span><span class="params">(graph, start, end, path)</span>:</span></span><br><span class="line">    <span class="comment"># 查找所有的路径</span></span><br><span class="line">    path = path + [start]</span><br><span class="line">    <span class="keyword">if</span> start == end:</span><br><span class="line">        <span class="keyword">return</span> [path]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> start <span class="keyword">in</span> graph.keys():</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    paths = []</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> graph[start]:</span><br><span class="line">        <span class="keyword">if</span> node <span class="keyword">not</span> <span class="keyword">in</span> path:</span><br><span class="line">            newpaths = find_all_paths(graph, node, end, path)</span><br><span class="line">            <span class="keyword">for</span> newpath <span class="keyword">in</span> newpaths:</span><br><span class="line">                paths.append(newpath)</span><br><span class="line">    <span class="keyword">return</span> paths</span><br><span class="line">    </span><br><span class="line">pathss = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(I):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(I):</span><br><span class="line">        <span class="keyword">if</span> RouteGraph.get_edge(i, j) == <span class="number">1</span>:</span><br><span class="line">            start = STATIO[i]</span><br><span class="line">            end = STATIO[j]</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> pathss.keys():</span><br><span class="line">                pathss[i] = [j]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pathss[i].append(j)</span><br><span class="line"><span class="comment"># pathss是记录每个站点接触的站点list</span></span><br><span class="line"><span class="comment"># print(pathss)</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>dijkstra算法具体分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dijkstra_shortest_pathS</span><span class="params">(graph, v0, endpos)</span>:</span></span><br><span class="line">    vnum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pathss.keys():</span><br><span class="line">        vnum += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= v0 &lt; vnum</span><br><span class="line">    <span class="comment"># 长为vnum的表记录路径</span></span><br><span class="line">    paths = [<span class="literal">None</span>] * vnum</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    cands = PrioQueue([(<span class="number">0</span>, v0, v0)])</span><br><span class="line">    <span class="keyword">while</span> count &lt; vnum <span class="keyword">and</span> <span class="keyword">not</span> cands.is_empty():</span><br><span class="line">        plen, u, vmin = cands.dequeue()  </span><br><span class="line">        <span class="keyword">if</span> paths[vmin]:  </span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        paths[vmin] = (u, plen)  </span><br><span class="line">        <span class="comment"># print(u, plen)</span></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> graph[vmin]:  </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> paths[v]:  </span><br><span class="line">                cands.enqueue((plen + <span class="number">1</span>, vmin, v))</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> paths</span><br></pre></td></tr></table></figure>
</li>
<li><p>stationController 部分</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> stationplan <span class="keyword">import</span> computefshortestpath</span><br><span class="line"><span class="keyword">from</span> stationplan <span class="keyword">import</span> getInfo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getShort</span><span class="params">(start, end)</span>:</span></span><br><span class="line">    stationnum, s = computefshortestpath(start, end)</span><br><span class="line">    <span class="keyword">return</span> stationnum, s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getInfoStation</span><span class="params">()</span>:</span></span><br><span class="line">    stationnumlist, stationlist = getInfo()</span><br><span class="line">    <span class="keyword">return</span> stationnumlist, stationlist</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    a, b = getInfoStation()</span><br><span class="line">    print(type(a))</span><br><span class="line">    print(type(b))</span><br></pre></td></tr></table></figure>

<ul>
<li>stationController中具体使用的函数分析</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确定出发点和最后的站点</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">computefshortestpath</span><span class="params">(startpos, endpos)</span>:</span></span><br><span class="line">    s1 = STATION_NUM[startpos]</span><br><span class="line">    e1 = STATION_NUM[endpos]</span><br><span class="line">    <span class="comment"># print(s1,e1)</span></span><br><span class="line">    paths = dijkstra_shortest_pathS(pathss, s1, e1)</span><br><span class="line">    <span class="comment"># print(paths)</span></span><br><span class="line">    b = []</span><br><span class="line">    p = paths[e1][<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print(paths[e1])</span></span><br><span class="line">    b.append(STATIO[p])</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p1 = paths[p][<span class="number">0</span>]</span><br><span class="line">        p = p1</span><br><span class="line">        b.append(STATIO[p])</span><br><span class="line">        <span class="keyword">if</span> p == s1:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    b.reverse()</span><br><span class="line">    <span class="keyword">if</span> s1 != e1:</span><br><span class="line">        b.append(STATIO[e1])</span><br><span class="line">    stationnumo = len(b)</span><br><span class="line"></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    s += b[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(b) - <span class="number">1</span>):</span><br><span class="line">        a1 = set(datanum[b[i - <span class="number">1</span>]])</span><br><span class="line">        b1 = set(datanum[b[i + <span class="number">1</span>]])</span><br><span class="line">        c1 = set(datanum[b[i]])</span><br><span class="line">        <span class="comment"># 如果没有交集，说明不是同一条路,对当前站点前后站点进行分析，如果两个站点属于</span></span><br><span class="line">        <span class="comment"># 的站点线号没有发生重叠，说明当前线路在该站点没有进行换乘</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> len(a1 &amp; b1):</span><br><span class="line">            <span class="keyword">if</span> len(datanum[b[i + <span class="number">1</span>]]) != <span class="number">0</span>:</span><br><span class="line">                s += <span class="string">"-"</span> + str((list(set(datanum[b[i]]) &amp; b1)[<span class="number">0</span>])) + <span class="string">"号线"</span></span><br><span class="line">            s += <span class="string">"-"</span> + b[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s += <span class="string">"-"</span> + b[i]</span><br><span class="line">    s += <span class="string">"-"</span> + b[len(b) - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> stationnumo, s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getInfo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> data, STATION_NUM</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="flask-app的分析："><a href="#flask-app的分析：" class="headerlink" title="flask app的分析："></a>flask app的分析：</h2><ul>
<li>flask具体作用类似与springboot，是python后端的一个框架，对新手及其友好，而json包则是用来处理json输出格式的一个工具</li>
<li>具体详情查看<a href="http://docs.jinkan.org/docs/flask/" target="_blank" rel="noopener">flask官方中文文档</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> stationController <span class="keyword">import</span> getShort</span><br><span class="line"><span class="keyword">from</span> stationController <span class="keyword">import</span> getInfoStation</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/getStationInfo', methods=['GET'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getStationInfo</span><span class="params">()</span>:</span></span><br><span class="line">    num = request.args[<span class="string">"num"</span>]</span><br><span class="line">    num = int(num)</span><br><span class="line">    data, stationlist = getInfoStation()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> num:</span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">"code"</span>: <span class="number">500</span>,</span><br><span class="line">            <span class="string">"msg"</span>: <span class="string">"the service make a mistake -.-"</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        strmsg = data[num]</span><br><span class="line">        print(strmsg)</span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">"code"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"msg"</span>: strmsg</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> json.dumps(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/getShortestPath', methods=['GET'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getShortestPath</span><span class="params">()</span>:</span></span><br><span class="line">    start = request.args[<span class="string">'start'</span>]</span><br><span class="line">    end = request.args[<span class="string">'end'</span>]</span><br><span class="line">    data, stationlist = getInfoStation()</span><br><span class="line">    print(start <span class="keyword">not</span> <span class="keyword">in</span> stationlist.keys() <span class="keyword">and</span> end <span class="keyword">not</span> <span class="keyword">in</span> stationlist.keys)</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> start <span class="keyword">or</span> <span class="keyword">not</span> end) <span class="keyword">or</span> (start <span class="keyword">not</span> <span class="keyword">in</span> stationlist.keys() <span class="keyword">or</span> end <span class="keyword">not</span> <span class="keyword">in</span> stationlist.keys()):</span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">"code"</span>: <span class="number">501</span>,</span><br><span class="line">            <span class="string">"msg"</span>: <span class="string">"please input the correct start and end station -.-"</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        stationnum, strmsg = getShort(start, end)</span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">"code"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">"msg"</span>: strmsg,</span><br><span class="line">            <span class="string">"stationnum"</span>: stationnum</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> json.dumps(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">"0.0.0.0"</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>flask具体demo已经部署在服务器上，返回信息，请求方式等具体请查看接口文档：<a href="https://www.showdoc.cc/501748289952061?page_id=2960311511791788" target="_blank" rel="noopener">传送门</a></li>
</ul>
<h2 id="安卓部分"><a href="#安卓部分" class="headerlink" title="安卓部分"></a>安卓部分</h2><ul>
<li>编译器使用AS进行开发</li>
<li>使用友好的流线式布局进行开发</li>
<li>布局代码如下:</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line"></span><br><span class="line">&lt;LinearLayout xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    xmlns:tools=<span class="string">"http://schemas.android.com/tools"</span></span><br><span class="line">    android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">    android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">    android:paddingBottom=<span class="string">"10dp"</span></span><br><span class="line">    android:paddingLeft=<span class="string">"10dp"</span></span><br><span class="line">    android:paddingRight=<span class="string">"10dp"</span></span><br><span class="line">    android:paddingTop=<span class="string">"30dp"</span></span><br><span class="line">    android:orientation=<span class="string">"vertical"</span></span><br><span class="line">    tools:context=<span class="string">".MainActivity"</span> &gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=<span class="string">"@+id/textView1"</span></span><br><span class="line">        android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">        android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">        android:text=<span class="string">"请选择站点线路起点线"</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"141dp"</span></span><br><span class="line">        android:layout_gravity=<span class="string">"center"</span></span><br><span class="line">        android:orientation=<span class="string">"vertical"</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Spinner</span><br><span class="line">            android:id=<span class="string">"@+id/spinner1"</span></span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"50dp"</span> /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Spinner</span><br><span class="line">            android:id=<span class="string">"@+id/spinner2"</span></span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"50dp"</span></span><br><span class="line">            android:layout_marginTop=<span class="string">"20dp"</span> /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=<span class="string">"@+id/textView2"</span></span><br><span class="line">        android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">        android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">        android:text=<span class="string">"请选择站点线路终点线"</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"141dp"</span></span><br><span class="line">        android:layout_gravity=<span class="string">"center"</span></span><br><span class="line">        android:orientation=<span class="string">"vertical"</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Spinner</span><br><span class="line">            android:id=<span class="string">"@+id/spinner3"</span></span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"50dp"</span> /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Spinner</span><br><span class="line">            android:id=<span class="string">"@+id/spinner4"</span></span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"50dp"</span></span><br><span class="line">            android:layout_marginTop=<span class="string">"20dp"</span></span><br><span class="line"></span><br><span class="line">            /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line">    &lt;Button</span><br><span class="line">        android:id=<span class="string">"@+id/searchButton"</span></span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"40dp"</span></span><br><span class="line">        android:text=<span class="string">"搜索最短路线"</span>&gt;</span><br><span class="line">    &lt;/Button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=<span class="string">"@+id/showShortestPath"</span></span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">        android:text=<span class="string">""</span>&gt;</span><br><span class="line">    &lt;/TextView&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>对与spinner（下拉框的集联操作使用xml进行了储存）</p>
</li>
<li><p>当选中相应的station值时进行选择第二个spinner中的应该显示的值</p>
</li>
<li><p>格式如下</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">    &lt;resources&gt;</span><br><span class="line">        &lt;string-array name=<span class="string">"station"</span>&gt;</span><br><span class="line">            &lt;item&gt;-站点线路-&lt;/item&gt;</span><br><span class="line">            &lt;item&gt;1&lt;/item&gt;</span><br><span class="line">            &lt;item&gt;2&lt;/item&gt;</span><br><span class="line">            &lt;item&gt;3&lt;/item&gt;</span><br><span class="line">            &lt;item&gt;5&lt;/item&gt;</span><br><span class="line">            &lt;item&gt;6&lt;/item&gt;</span><br><span class="line">            &lt;item&gt;9&lt;/item&gt;</span><br><span class="line">         &lt;/string-array&gt;</span><br><span class="line">         &lt;string-array name=<span class="string">"station1"</span>&gt;</span><br><span class="line">             &lt;item&gt;-站点-&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;刘园&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;西横堤&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;果酒厂&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;本溪路&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;勤俭道&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;洪湖里&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;西站&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;西北角&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;西南角&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;二纬路&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;海光寺&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;鞍山道&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;营口道&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;小白楼&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;下瓦房&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;南楼&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;土城&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;陈塘庄&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;复兴门&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;华山里&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;财经大学&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;双林&lt;/item&gt;</span><br><span class="line">             &lt;item&gt;李楼&lt;/item&gt;</span><br><span class="line">         &lt;/string-array&gt;</span><br><span class="line">   			......</span><br><span class="line">     &lt;/resources&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>代码控制：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">....</span><br><span class="line"><span class="keyword">if</span> (pro.equals(<span class="string">"1"</span>)) &#123;</span><br><span class="line">     cityAdapter = ArrayAdapter.createFromResource(</span><br><span class="line">             MainActivity.<span class="keyword">this</span>, R.array.station1,</span><br><span class="line">             android.R.layout.simple_spinner_dropdown_item);</span><br><span class="line">     sr4.setAdapter(cityAdapter);</span><br><span class="line">     sr4.setOnItemSelectedListener(<span class="keyword">new</span> AdapterView.OnItemSelectedListener() &#123;</span><br><span class="line">         <span class="meta">@Override</span></span><br><span class="line">         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemSelected</span><span class="params">(AdapterView&lt;?&gt; parent, View view, <span class="keyword">int</span> position, <span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">             String strstation = MainActivity.<span class="keyword">this</span>.getResources().getStringArray(R.array.station1)[position];</span><br><span class="line">             sr4Val = strstation;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="meta">@Override</span></span><br><span class="line">         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNothingSelected</span><span class="params">(AdapterView&lt;?&gt; parent)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">     &#125;);</span><br><span class="line">&#125; </span><br><span class="line">.....</span><br></pre></td></tr></table></figure>

<hr>
<ul>
<li>demo图<br><img src="https://img-blog.csdnimg.cn/20191008164044443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nvczc2OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
<li>使用okhttps获得json数据，get方式</li>
<li>相应的as添加jar包方式：</li>
<li>打开路径：file-&gt;project Structure-&gt;Depndences-&gt;app-&gt;+号  搜索相应的包即可</li>
<li>博主用的是 okhttp:2.7.5的包</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20191008164422968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nvczc2OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendGetRequest</span><span class="params">(<span class="keyword">final</span> String url,<span class="keyword">final</span> String startpos,<span class="keyword">final</span>  String endpos)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    OkHttpClient client = <span class="keyword">new</span> OkHttpClient();<span class="comment">//创建OkHttpClient对象</span></span><br><span class="line">                    Request request = <span class="keyword">new</span> Request.Builder()</span><br><span class="line">                            .url(<span class="string">"http://139.9.90.185/getShortestPath?start="</span>+startpos+<span class="string">"&amp;end="</span>+endpos)<span class="comment">//请求接口。如果需要传参拼接到接口后面。</span></span><br><span class="line">                            .build();<span class="comment">//创建Request 对象</span></span><br><span class="line">                    Response response = <span class="keyword">null</span>;</span><br><span class="line">                    response = client.newCall(request).execute();<span class="comment">//得到Response 对象</span></span><br><span class="line">                    <span class="keyword">if</span> (response.isSuccessful()) &#123;</span><br><span class="line">                        Log.d(<span class="string">"kwwl"</span>,<span class="string">"response.code()=="</span>+response.code());</span><br><span class="line">                        Log.d(<span class="string">"kwwl"</span>,<span class="string">"response.message()=="</span>+response.message());</span><br><span class="line"><span class="comment">//                        Log.d("kwwl","res=="+response.body().string());</span></span><br><span class="line">                        String resdata = response.body().string();</span><br><span class="line">                        System.out.println(resdata);</span><br><span class="line"></span><br><span class="line">                        <span class="comment">//此时的代码执行在子线程，修改UI的操作请使用handler跳转到UI线程。</span></span><br><span class="line">                            JSONObject jsonObject = <span class="keyword">new</span> JSONObject(resdata);</span><br><span class="line">                            String code = (jsonObject.getString(<span class="string">"code"</span>));</span><br><span class="line">                            <span class="keyword">if</span>(Integer.parseInt(code)==<span class="number">0</span>) &#123;</span><br><span class="line">                                String resultpath = (jsonObject.getString(<span class="string">"msg"</span>));</span><br><span class="line">                                String resultnum = (jsonObject.getString(<span class="string">"stationnum"</span>));</span><br><span class="line">                                show(<span class="string">"站点数:"</span> + resultnum + <span class="string">"\n"</span> + <span class="string">"站点最短路径:"</span> + resultpath);</span><br><span class="line">                                Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">"正在搜索中,请稍后"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">                            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                String msg = (jsonObject.getString(<span class="string">"msg"</span>));</span><br><span class="line">                                show(<span class="string">"提示信息:"</span>+msg);</span><br><span class="line">                                Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">"提示信息:"</span>+msg,Toast.LENGTH_SHORT).show();</span><br><span class="line">                            &#125;</span><br><span class="line"><span class="comment">//                            System.out.println(result);</span></span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        show(<span class="string">"请求出错,请选择正确的站点请求"</span>);</span><br><span class="line">                        Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">"请求出错,请选择正确的站点请求"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"> <span class="comment">//显示在下方的TextView中</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">final</span> String result)</span> </span>&#123;</span><br><span class="line">        runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                textShowPaths.setText(result);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/09/17/地铁项目/" rel="next" title="地铁项目">
                <i class="fa fa-chevron-left"></i> 地铁项目
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Athony Oliver</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#基于图结构实现地铁乘坐线路查询"><span class="nav-number">1.</span> <span class="nav-text">基于图结构实现地铁乘坐线路查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#问题描述"><span class="nav-number">1.1.</span> <span class="nav-text">问题描述</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设计需求"><span class="nav-number">2.</span> <span class="nav-text">设计需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据存储格式"><span class="nav-number">3.</span> <span class="nav-text">数据存储格式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数据文本读取代码"><span class="nav-number">3.1.</span> <span class="nav-text">数据文本读取代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#flask-app的分析："><span class="nav-number">4.</span> <span class="nav-text">flask app的分析：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安卓部分"><span class="nav-number">5.</span> <span class="nav-text">安卓部分</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Athony Oliver</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
